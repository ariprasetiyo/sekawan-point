<configuration scan="true">
    <appender name="FILE-STREAM" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>/opt/data/logs/sekawan-point-messages.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy">
            <fileNamePattern>/opt/data/logs/BACKUP_LOG/sekawan-point-stream.log.%i.gz</fileNamePattern>
            <minIndex>1</minIndex>
            <maxIndex>5</maxIndex>
        </rollingPolicy>
        <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">
            <maxFileSize>100MB</maxFileSize>
        </triggeringPolicy>
        <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder">
            <providers>
                <timestamp>
                    <fieldName>ts</fieldName>
                </timestamp>
                <context/>
                <logLevel/>
                <logstashMarkers/>
                <message/>
                <stackTrace/>
            </providers>
        </encoder>
    </appender>
    
    <appender name="FILE-MESSAGES" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>/opt/data/logs/sekawan-point-messages.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy">
            <fileNamePattern>/opt/data/logs/BACKUP_LOG/sekawan-point-messages.log.%i.gz</fileNamePattern>
            <minIndex>1</minIndex>
            <maxIndex>5</maxIndex>
        </rollingPolicy>
        <triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">
            <maxFileSize>100MB</maxFileSize>
        </triggeringPolicy>
        <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder">
            <providers>
                <timestamp>
                    <fieldName>ts</fieldName>
                </timestamp>
                <context/>
                <logLevel/>
                <logstashMarkers/>
                <arguments>
                    <fieldName>arguments</fieldName>
                    <includeNonStructuredArguments>true</includeNonStructuredArguments>
                    <nonStructuredArgumentsFieldPrefix>arg</nonStructuredArgumentsFieldPrefix>
                </arguments>
                <stackTrace/>
            </providers>
        </encoder>
    </appender>
    
    <logger name="id.sekawan.mylog" level="INFO" additivity="false">
        <appender-ref ref="FILE-MESSAGES"/>
    </logger>
    
    <root level="INFO">
        <appender-ref ref="FILE-STREAM"/>
    </root>
    
</configuration>
